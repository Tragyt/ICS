{% extends 'base.html' %}
{% block content %}

{% include "webauthn.html" %}

<div class="flex justify-center min-h-screen pt-24">
    <div class="max-w-2xl mx-auto">
        <form id="registerForm" class="flex-col max-w-sm mx-auto space-y-2">
            <h4 class="text-2xl font-bold">Register User</h4>
            <div class="flex-col flex mt-2">
                <label for="name" class="mb-1 font-bold">Name</label>
                <input type="text" name="name" id="name" class="border border-black rounded shadow p-1">
            </div>
            <div class="flex-col flex mt-2">
                <label for="username" class="mb-1 font-bold">Username</label>
                <input type="text" name="username" id="username" class="border border-black rounded shadow p-1"
                    required>
            </div>
            <div>
                <button
                    class="bg-green-600 font-bold py-2 px-4 uppercase shadow text-white rounded hover:bg-green-700 hover:shadow-lg"
                    type="submit">
                    Register
                </button>
            </div>
        </form>
        <div id="errorMsg" class="text-red-600 mt-2 hidden"></div>
    </div>

    <script>
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const form = e.target;
            const errorDiv = document.getElementById('errorMsg');

            const res = await register_user(form.name.value, form.username.value);
            if (!res) {
                errorDiv.textContent = 'Registration failed.';
                errorDiv.classList.remove('hidden');
            }
        });
    </script>
</div>
{% endblock content %}